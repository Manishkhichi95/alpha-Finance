import { Injectable } from '@angular/core';
import { Web3Service } from './services/WEb3Service.service';

@Injectable({
  providedIn: 'root'
})
export class ReserveInCBService {
  web3: any;
  accounts: any;

  constructor(private web3Service: Web3Service) {
    this.initializeReserve();
  }

  async initializeReserve(){
    this.web3 = this.web3Service.getWeb3();

    this.accounts = await window.ethereum.request({ method: 'eth_requestAccounts' })

    const lendingPoolConfigurator = new this.web3.eth.Contract([{ "anonymous": false, "inputs": [{ "indexed": true, "internalType": "address", "name": "asset", "type": "address" }, { "indexed": true, "internalType": "address", "name": "proxy", "type": "address" }, { "indexed": true, "internalType": "address", "name": "implementation", "type": "address" }], "name": "ATokenUpgraded", "type": "event" }, { "anonymous": false, "inputs": [{ "indexed": true, "internalType": "address", "name": "asset", "type": "address" }], "name": "BorrowingDisabledOnReserve", "type": "event" }, { "anonymous": false, "inputs": [{ "indexed": true, "internalType": "address", "name": "asset", "type": "address" }, { "indexed": false, "internalType": "bool", "name": "stableRateEnabled", "type": "bool" }], "name": "BorrowingEnabledOnReserve", "type": "event" }, { "anonymous": false, "inputs": [{ "indexed": true, "internalType": "address", "name": "asset", "type": "address" }, { "indexed": false, "internalType": "uint256", "name": "ltv", "type": "uint256" }, { "indexed": false, "internalType": "uint256", "name": "liquidationThreshold", "type": "uint256" }, { "indexed": false, "internalType": "uint256", "name": "liquidationBonus", "type": "uint256" }], "name": "CollateralConfigurationChanged", "type": "event" }, { "anonymous": false, "inputs": [{ "indexed": true, "internalType": "address", "name": "asset", "type": "address" }], "name": "ReserveActivated", "type": "event" }, { "anonymous": false, "inputs": [{ "indexed": true, "internalType": "address", "name": "asset", "type": "address" }], "name": "ReserveDeactivated", "type": "event" }, { "anonymous": false, "inputs": [{ "indexed": true, "internalType": "address", "name": "asset", "type": "address" }, { "indexed": false, "internalType": "uint256", "name": "decimals", "type": "uint256" }], "name": "ReserveDecimalsChanged", "type": "event" }, { "anonymous": false, "inputs": [{ "indexed": true, "internalType": "address", "name": "asset", "type": "address" }, { "indexed": false, "internalType": "uint256", "name": "factor", "type": "uint256" }], "name": "ReserveFactorChanged", "type": "event" }, { "anonymous": false, "inputs": [{ "indexed": true, "internalType": "address", "name": "asset", "type": "address" }], "name": "ReserveFrozen", "type": "event" }, { "anonymous": false, "inputs": [{ "indexed": true, "internalType": "address", "name": "asset", "type": "address" }, { "indexed": true, "internalType": "address", "name": "aToken", "type": "address" }, { "indexed": false, "internalType": "address", "name": "stableDebtToken", "type": "address" }, { "indexed": false, "internalType": "address", "name": "variableDebtToken", "type": "address" }, { "indexed": false, "internalType": "address", "name": "interestRateStrategyAddress", "type": "address" }], "name": "ReserveInitialized", "type": "event" }, { "anonymous": false, "inputs": [{ "indexed": true, "internalType": "address", "name": "asset", "type": "address" }, { "indexed": false, "internalType": "address", "name": "strategy", "type": "address" }], "name": "ReserveInterestRateStrategyChanged", "type": "event" }, { "anonymous": false, "inputs": [{ "indexed": true, "internalType": "address", "name": "asset", "type": "address" }], "name": "ReserveUnfrozen", "type": "event" }, { "anonymous": false, "inputs": [{ "indexed": true, "internalType": "address", "name": "asset", "type": "address" }, { "indexed": true, "internalType": "address", "name": "proxy", "type": "address" }, { "indexed": true, "internalType": "address", "name": "implementation", "type": "address" }], "name": "StableDebtTokenUpgraded", "type": "event" }, { "anonymous": false, "inputs": [{ "indexed": true, "internalType": "address", "name": "asset", "type": "address" }], "name": "StableRateDisabledOnReserve", "type": "event" }, { "anonymous": false, "inputs": [{ "indexed": true, "internalType": "address", "name": "asset", "type": "address" }], "name": "StableRateEnabledOnReserve", "type": "event" }, { "anonymous": false, "inputs": [{ "indexed": true, "internalType": "address", "name": "asset", "type": "address" }, { "indexed": true, "internalType": "address", "name": "proxy", "type": "address" }, { "indexed": true, "internalType": "address", "name": "implementation", "type": "address" }], "name": "VariableDebtTokenUpgraded", "type": "event" }, { "inputs": [{ "internalType": "address", "name": "asset", "type": "address" }], "name": "activateReserve", "outputs": [], "stateMutability": "nonpayable", "type": "function" }, { "inputs": [{ "components": [{ "internalType": "address", "name": "aTokenImpl", "type": "address" }, { "internalType": "address", "name": "stableDebtTokenImpl", "type": "address" }, { "internalType": "address", "name": "variableDebtTokenImpl", "type": "address" }, { "internalType": "uint8", "name": "underlyingAssetDecimals", "type": "uint8" }, { "internalType": "address", "name": "interestRateStrategyAddress", "type": "address" }, { "internalType": "address", "name": "underlyingAsset", "type": "address" }, { "internalType": "address", "name": "treasury", "type": "address" }, { "internalType": "address", "name": "incentivesController", "type": "address" }, { "internalType": "uint256", "name": "allocPoint", "type": "uint256" }, { "internalType": "string", "name": "underlyingAssetName", "type": "string" }, { "internalType": "string", "name": "aTokenName", "type": "string" }, { "internalType": "string", "name": "aTokenSymbol", "type": "string" }, { "internalType": "string", "name": "variableDebtTokenName", "type": "string" }, { "internalType": "string", "name": "variableDebtTokenSymbol", "type": "string" }, { "internalType": "string", "name": "stableDebtTokenName", "type": "string" }, { "internalType": "string", "name": "stableDebtTokenSymbol", "type": "string" }, { "internalType": "bytes", "name": "params", "type": "bytes" }], "internalType": "struct ILendingPoolConfigurator.InitReserveInput[]", "name": "input", "type": "tuple[]" }], "name": "batchInitReserve", "outputs": [], "stateMutability": "nonpayable", "type": "function" }, { "inputs": [{ "internalType": "address", "name": "asset", "type": "address" }, { "internalType": "uint256", "name": "ltv", "type": "uint256" }, { "internalType": "uint256", "name": "liquidationThreshold", "type": "uint256" }, { "internalType": "uint256", "name": "liquidationBonus", "type": "uint256" }], "name": "configureReserveAsCollateral", "outputs": [], "stateMutability": "nonpayable", "type": "function" }, { "inputs": [{ "internalType": "address", "name": "asset", "type": "address" }], "name": "deactivateReserve", "outputs": [], "stateMutability": "nonpayable", "type": "function" }, { "inputs": [{ "internalType": "address", "name": "asset", "type": "address" }], "name": "disableBorrowingOnReserve", "outputs": [], "stateMutability": "nonpayable", "type": "function" }, { "inputs": [{ "internalType": "address", "name": "asset", "type": "address" }], "name": "disableReserveStableRate", "outputs": [], "stateMutability": "nonpayable", "type": "function" }, { "inputs": [{ "internalType": "address", "name": "asset", "type": "address" }, { "internalType": "bool", "name": "stableBorrowRateEnabled", "type": "bool" }], "name": "enableBorrowingOnReserve", "outputs": [], "stateMutability": "nonpayable", "type": "function" }, { "inputs": [{ "internalType": "address", "name": "asset", "type": "address" }], "name": "enableReserveStableRate", "outputs": [], "stateMutability": "nonpayable", "type": "function" }, { "inputs": [{ "internalType": "address", "name": "asset", "type": "address" }], "name": "freezeReserve", "outputs": [], "stateMutability": "nonpayable", "type": "function" }, { "inputs": [{ "internalType": "contract ILendingPoolAddressesProvider", "name": "provider", "type": "address" }], "name": "initialize", "outputs": [], "stateMutability": "nonpayable", "type": "function" }, { "inputs": [{ "internalType": "bool", "name": "val", "type": "bool" }], "name": "setPoolPause", "outputs": [], "stateMutability": "nonpayable", "type": "function" }, { "inputs": [{ "internalType": "address", "name": "asset", "type": "address" }, { "internalType": "uint256", "name": "reserveFactor", "type": "uint256" }], "name": "setReserveFactor", "outputs": [], "stateMutability": "nonpayable", "type": "function" }, { "inputs": [{ "internalType": "address", "name": "asset", "type": "address" }, { "internalType": "address", "name": "rateStrategyAddress", "type": "address" }], "name": "setReserveInterestRateStrategyAddress", "outputs": [], "stateMutability": "nonpayable", "type": "function" }, { "inputs": [{ "internalType": "address", "name": "asset", "type": "address" }], "name": "unfreezeReserve", "outputs": [], "stateMutability": "nonpayable", "type": "function" }, { "inputs": [{ "components": [{ "internalType": "address", "name": "asset", "type": "address" }, { "internalType": "address", "name": "treasury", "type": "address" }, { "internalType": "address", "name": "incentivesController", "type": "address" }, { "internalType": "string", "name": "name", "type": "string" }, { "internalType": "string", "name": "symbol", "type": "string" }, { "internalType": "address", "name": "implementation", "type": "address" }, { "internalType": "bytes", "name": "params", "type": "bytes" }], "internalType": "struct ILendingPoolConfigurator.UpdateATokenInput", "name": "input", "type": "tuple" }], "name": "updateAToken", "outputs": [], "stateMutability": "nonpayable", "type": "function" }, { "inputs": [{ "components": [{ "internalType": "address", "name": "asset", "type": "address" }, { "internalType": "address", "name": "incentivesController", "type": "address" }, { "internalType": "string", "name": "name", "type": "string" }, { "internalType": "string", "name": "symbol", "type": "string" }, { "internalType": "address", "name": "implementation", "type": "address" }, { "internalType": "bytes", "name": "params", "type": "bytes" }], "internalType": "struct ILendingPoolConfigurator.UpdateDebtTokenInput", "name": "input", "type": "tuple" }], "name": "updateStableDebtToken", "outputs": [], "stateMutability": "nonpayable", "type": "function" }, { "inputs": [{ "components": [{ "internalType": "address", "name": "asset", "type": "address" }, { "internalType": "address", "name": "incentivesController", "type": "address" }, { "internalType": "string", "name": "name", "type": "string" }, { "internalType": "string", "name": "symbol", "type": "string" }, { "internalType": "address", "name": "implementation", "type": "address" }, { "internalType": "bytes", "name": "params", "type": "bytes" }], "internalType": "struct ILendingPoolConfigurator.UpdateDebtTokenInput", "name": "input", "type": "tuple" }], "name": "updateVariableDebtToken", "outputs": [], "stateMutability": "nonpayable", "type": "function" }], '0x308AE4EdA4dD95c23a3c2968D6951ac3f589773B')
    const params = {
      aTokenImpl: '0xEf9bBa295a4b3acB014304C4Ada27a3D190E3BB2',
      stableDebtTokenImpl: '0x6695EdB1671d78E434224977709911BB1F5AC1A9',
      variableDebtTokenImpl: '0xf67a2D777bDC066793aD79873fCfA33Fb01ab619',
      underlyingAssetDecimals: 18,
      interestRateStrategyAddress: '0xc6F3222E3a4fC4Fda7170f34FE8C84FAa7A20e4C',
      underlyingAsset: '0x9C09c96eEa005C9C77be44fa52001FC5c41dac17',
      treasury: '0x58F3499Ce37791fef39D0b6F6339c60844895AFc',
      incentivesController: '0x530C6d01F7Ea4f968CEB9053708431a089A9a352',
      allocPoint: 10,
      underlyingAssetName: 'WETH',
      aTokenName: 'WETHATOKEN',
      aTokenSymbol: 'WETHATOKEN',
      variableDebtTokenName: 'WETHVDTOKEN',
      variableDebtTokenSymbol: 'WETHVDTOKEN',
      stableDebtTokenName: 'WETHSDTOKEN',
      stableDebtTokenSymbol: 'WETHSDTOKEN',
      params: '0x10'
    };
    const batchInitReserve = lendingPoolConfigurator.methods.batchInitReserve([params]).send(
      {
        from: this.accounts[0],
        data: lendingPoolConfigurator.methods.batchInitReserve([params]).encodeABI()
      }
    );
    batchInitReserve.then((res:any)=>{
    })
  }
}
